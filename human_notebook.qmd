------------------------------------------------------------------------

---
title: "Santé humaine liée à l'obésité (bloc-notes)"
author: "Amal_Abarou, Fiona_Guiwala, Audrey_Tchuente, Leslie_Tankam"
date: "`r Sys.Date()`"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: bibliography/references.bib
---

<!--# Dans les différentes sections, vous trouverez des indicateurs "...Vos XXX ici..." Vous devez bien sûr REMPLACER ces indicateurs par votre propre texte. Ne les laissez pas dans votre version finale du document. Vous devez travailler dans le même document (pas question de faire un document séparé par étudiant). Gérez les conflits éventuels. -->

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configuration de l'environnement SciViews::R
SciViews::R("infer", lang = "fr")
```

# Introduction et but

Au cours des dernières décennies, la santé humaine a connu un déclin alarmant dans de nombreuses régions du monde. L'obésité est l'un des principaux facteurs contribuant à cette tendance inquiétante, car elle peut entraîner un large éventail de problèmes de santé, notamment des maladies cardiovasculaires, des accidents vasculaires cérébraux, des cancers, des troubles musculo-squelettiques et des troubles mentaux. En outre, l'obésité est souvent associée à un mode de vie sédentaire et à une alimentation malsaine, qui peuvent également avoir des effets négatifs sur la santé.

@lebacq2015 a étudié différents indices permettant de quantifier, entre autres, l'obésité des personnes. Notre but est de tester quelques-uns de ces indices sur un échantillon de la population du Hainaut âgée de 18 ans ou plus, et d'établir des liens avec le mode de vie ou l'alimentation.

# Matériel et méthodes

Les données ont été collectées par un groupe d'une trentaine d'expérimentateurs qui se sont réparti le travail. Le choix des mesures à réaliser a fait l'objet d'un consensus au sein du groupe par l'élaboration d'un dictionnaire des données commun. Les mesures sujettes à variation (la masse plus particulièrement) ont fait l'objet d'une intercalibration. Ces données sont pseudonymisées afin de respecter l'anonymat des sujets étudiés en respect du RGPD (règlement général de la protection des données, règlement d'application en Europe).

La description des données et les tests statistiques sont réalisés dans la SciViews Box 2024 en utilisant [Saturn Cloud](https://saturncloud.io) (Linux) avec le [logiciel R](https://www.r-project.org) (`r R.version.string`).

# Résultats

## Description des données

<!--% Ajoutez un chunk d'importation des données à partir de vos données remaniées dans `data/biometry.rds`. Inspirez-vous de vos projets individuels pour écrire correctement ces chunks. -->

```{r}
# Chargement des données depuis le fichier 
biometry_data <- read("data/biometry.rds")
# Tableau des premières et dernières lignes
tabularise$headtail(biometry_data)
# Description des données
skimr::skim(biometry_data)
```

<!--% Ensuite vous décrirez graphiquement (avec `chart()`) et numériquement (tableaux avec `tabularise()`, `skimr::skim()`, etc.) vos données. Chaque étudiant ajoute deux éléments descriptifs pertinents. -->

### Description par l'étudiant 1

```{r}
chart(data = biometry_data, ~ tour_taille %fill=% alimentation|alimentation) +
  geom_histogram(data = sselect(biometry_data,-alimentation),
    fill = "grey", bins = 25) + 
  geom_histogram(show.legend = TRUE, bins = 25) +
  ylab("Effectifs") +
  scale_fill_viridis_d()

```

### Description par l'étudiant 2

...Vos deux descriptions ici...

### Description par l'étudiant 3

```{r}
#Regroupage en tranche d'age 
## Recodage de biometry_data$age en biometry_data$age_rec
biometry_data$age_rec <- cut(biometry_data$age,
  include.lowest = TRUE,
  right = FALSE,
  dig.lab = 4,
  breaks = c(17, 30, 50, 70, 81),
  labels = c("17-29ans", "30-49ans", "50-69ans", "plus de 70ans"))

chart(data = biometry_data, ~ fast_food %fill=% genre | age_rec) +
  geom_bar(na.rm = TRUE, position = "dodge") +
  scale_fill_viridis_d() +
  labs(title = "Répartition de la consommation de fast-food par tranche d'âge",
  x = "Nombre de fast-food consommés par semaine",
  y = "Effectifs")
```

Interprétation

L'analyse de notre graphe montre que la consommation de fast-food est plus élevée chez les jeunes adultes (18-30 ans) et diminue avec l'âge, surtout après 50 ans. Les plus de 70 ans en consomment très peu. Une différence entre les sexes est visible chez les 18-30 ans, où les femmes semblent en consommer davantage que les hommes, mais cette tendance s'atténue avec l'âge. Cette étude souligne l'impact de l'âge et du sexe sur les habitudes alimentaires.

```{r}
biometry_data %>.%
  sgroup_by(., age_rec, genre, sucre) %>.%
  ssummarise(., "moyenne" = mean(fast_food),
    "n" = fn(sucre)) -> biometry_3
tabularise(biometry_3)
```

### Description par l'étudiant 4

```{r}
chart(data = biometry_data, masse_corr ~ genre %fill=% genre) +
  geom_boxplot() +
labs(title = "Distribution de la masse par genre",
       x = "Genre",
       y = "Masse (kg)")
cross_table <- biometry_data %>%
  group_by(., genre) %>%
  ssummarise(.,
    moyenne        = fmean(masse_corr),
    ecart_type     =  fsd(masse_corr),
    n              = fn(masse_corr)
    )
tabularise(cross_table)
```

La ligne épaisse à l'intérieur de chaque boîte représente la mediane de la masse pour chaque genre. Cette médiane est légèrement plus élevée chez les hommes que chez les femmes. Donc cette boîte à moustaches montre qu'il existe une légère différence dans la distribution de la masse entre les hommes et les femmes de cet échantillon, les hommes ayant tendance à avoir une masse médiane légèrement plus élevée et une dispersion légèrement plus grande.

Le tableau obtenu reflète une différence biologique habituelle, les hommes ayant généralement une masse musculaire plus élevée que les femmes. L'écart type est pratiquement similaire entre les hommes et les femmes de même que le nombre d'individu analyse. Comme conclusion : les hommes ont une masse corporelle moyenne plus élevée que les femmes ce qui correspond a la tendance physiologique générale

## Calcul d'indices

<!--% Calculez au moins quatre indices (un par étudiant) en vous basant sur la littérature et en relation avec votre question de recherche. Décrivez chaque indice avec une formule mathématique en LaTeX. Calculez une nouvelle variable dans votre tableau pour cet indice sur base de la formule mathématique. Si cela est pertinent, définissez aussi une variable facteur qui qualifie l'état de bonne santé selon une échelle qualitative. -->

<!--# N'hésitez pas à associer un graphique ou un tableau utiles pour visualiser/décrire vos indices calculés. -->

### Indice 1

<!--% Description et formule ci-dessous. -->

L'**Indice de Masse Adipeuse (IMA)** est un indicateur permettant d'estimer le pourcentage de graisse corporelle en fonction du tour de hanche et de la taille. Contrairement à l'IMC, il ne nécessite pas le poids corporel et est parfois considéré comme plus représentatif de la masse grasse, notamment pour certaines populations.

```{r indice1}
biometry_data <- biometry_data %>%
  smutate(
  taille_m = taille / 100,   # Conversion de la taille de cm en m
 IMA = (tour_hanche / (taille_m^1.5)) - 18  # Calcul de l'IMA
  )
```

<!--% Graphique ou tableau utilisant l'indice calculé.-->

```{r plot_indice1}
# Graphique ou tableau utilisant l'indice calculé.

```

<!--% Interprétation en quelques points du graphique ou tableau. -->

-   ...

-   ...

-   ...

### Indice 2

<!--% Description et formule ci-dessous. -->

Le rapport tour de taille sur tour de hanches (RTH) est une mesure anthropométrique qui permet d'évaluer la distribution de la graisse corporelle. Son élévation témoigne d'une accumulation de tissus graisseux au niveau abdominal

```{r indice2}
biometry_data <- biometry_data %>% 
  smutate(ttaille_tchanche = (tour_taille/tour_hanche))
```

<!--% Graphique ou tableau utilisant l'indice calculé.-->

```{r plot_indice2}
# Graphique ou tableau utilisant l'indice calculé.

```

<!--% Interprétation en quelques points du graphique ou tableau. -->

-   ...

-   ...

-   ...

### Indice 3

<!--% Description et formule ci-dessous. -->

L'**Indice de Masse Corporelle (IMC)** est une mesure simple et largement utilisée pour évaluer la corpulence d'une personne. Il permet d'estimer le rapport entre le poids et la taille d'un individu, en fournissant une évaluation du risque lié à la santé, tel que le surpoids, l'obésité ou l'insuffisance pondérale.

```{r indice3}
# Calcul de la ou des variables reprenant l'indice sous forme numérique (et facteur)
  biometry_data <- biometry_data %>.% 
smutate(biometry_data, imc = (masse_corr / (taille / 100)^2)) %>.%   
  drop_na(.)

  biometry_data <- biometry_data %>.% 
  smutate(biometry_data, imc_cat = case_when(
    imc < 18.5 ~ "sous-poids",
    imc >= 18.5 & imc < 25 ~ "poids-normal",
    imc >= 25 & imc < 30 ~ "surpoids",
    imc >= 30 ~ "obèse"))
    
  biometry_data$imc_cat <- ordered(biometry_data$imc_cat, 
  level = c("sous-poids", "poids-normal", "surpoids", "obèse"))

```

<!--% Graphique ou tableau utilisant l'indice calculé.-->

```{r plot_indice3}
# Graphique ou tableau utilisant l'indice calculé.
biometry_3_1 <- biometry_data %>.%
  sgroup_by(., genre, imc_cat) %>.%
  ssummarise(., 
  "n" = fn(imc)) %>.%
  smutate(., 
  "pourcentage" = (n / sum(n)) * 100)

tabularise(biometry_3_1)

```

<!--% Interprétation en quelques points du graphique ou tableau. -->

-   Les femmes présentent une proportion plus élevée de sous-poids et d'obésité que les hommes.

-   Les hommes ont une distribution plus homogène entre les catégories poids normal et surpoids.

-   La différence d\'IMC entre les sexes pourrait être liée à des facteurs biologiques, alimentaire ou comportementaux.

### Indice 4

<!--% Description et formule ci-dessous. -->

L'**Indice de Masse Grasse (IMG)** est une mesure qui estime le pourcentage de graisse corporelle d'une personne. Contrairement à l'IMC (indice de masse corporelle), qui ne fait pas de distinction entre la masse grasse et la masse musculaire, l'IMG offre une estimation plus précise de la composition corporelle.

```{r indice4}
# Calcul de la ou des variables reprenant l'indice sous forme numérique (et facteur)
     
biometry_data <- biometry_data %>%
  smutate(., 
   taille_m = taille / 100,
   IMG = (1.2 * imc) + (0.23 * age) - (10.8 * ifelse(genre == "H", 1, 0)) - 5.4) # Calcul de l'IMG en fonction du sexe

# Transformation en facteur (classification en catégories)
biometry_data <- biometry_data %>%
  smutate(., IMG_Categorie = cut(IMG, 
          breaks = c(-Inf, 10, 20, 25, 30, Inf), 
          labels = c("Très faible", "Faible", "Normal", "Élevé", "Obésité"),
                             ordered_result = TRUE))
```

<!--% Graphique ou tableau utilisant l'indice calculé.-->

```{r plot_indice4}
# Graphique ou tableau utilisant l'indice calculé.
chart(biometry_data, ~ IMG %fill=% genre | genre) +
  geom_density(binwidth = 2, alpha = 0.6, color = "black") +
  scale_fill_viridis_d() +
  labs(title = "Répartition de l'Indice de Masse Grasse",
       x = "IMG (%)",
       y = "Densité")
```

<!--% Interprétation en quelques points du graphique ou tableau. -->

-   Les plus hautes barres sont observées pour des valeurs courantes d'IMG se situant entre 15% et 35%. Ces valeurs correspondent généralement aux IMG normaux en fonctions des références.11

-   Des valeurs extrêmes et rares, très peu d'individus ont un IMG inférieur a 10% ou supérieur a 50% (un IMG \< 10% peut être observé chez les athlètes : très faible, tandis qu'un IMG \>50% indique une forte accumulation de masse grasse : obésité )

-   Cette distribution est asymétrique.

## Tests d'hypothèses

<!--% Dans cette partie, réalisez plusieurs tests d'hypothèses pour répondre à des questions en relation avec votre but. N'hésitez pas à employer les indices que vous avez calculés ci-dessus, ainsi que les variables de départ. Effectuez et interprétez au moins deux tests d'hypothèses pour chaque type ci-dessous. Répartissez le travail entre les étudiants : à chaque fois deux étudiants réalisent les deux tests et les deux autres les interprètent (les commits doivent bien montrer qui a fait quoi). -->

<!--# Chaque test d'hypothèse doit être correctement employé. Vous devez indiquer, pour chaque test, l'hypothèse nulle et l'hypothèse alternative. Vous devez vérifier les conditions d'application du test d'hypothèse. Vous le réalisez, et ensuite vous l'interprétez du point de vue statistique d'abord et biologique ensuite. -->

### Test de Chi^2^ 1

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_chi2_1}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_chi2_1}

```

<!--% Interprétation statistique et biologique -->

### Test de Chi^2^ 2

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_chi2_2}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_chi2_2}

```

<!--% Interprétation statistique et biologique -->

<!--# Travaillez jusqu'ici pour le module 7. -->

### Test t de Student 1

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_t_1}
## Recodage de biometry_data$fast_food en biometry_data$fast_food_rec
biometry_data$fast_food_rec <- cut(biometry_data$fast_food,
  include.lowest = TRUE,
  right = FALSE,
  dig.lab = 4,
  breaks = c(0, 1, 13) 
  )
biometry_data %>.%
  sgroup_by(., fast_food_rec) %>.%
  ssummarise(., mean = mean(IMG, na.rm = T)) 
```

<!-- Hypothèse nulle et alternative -->

H0 : mean \[0,1) - mean \[1,13\] = 0

H1 : mean \[0,1) - mean \[1,13\] != 0

<!-- Vérification des conditions d'application -->

```{r}
biometry_data 
biometry_data$imglog <- log(biometry_data$IMG)
car::qqPlot(biometry_data[["imglog"]], distribution = "norm",
  envelope = 0.95, col = "Black", ylab = "Distrubution de l'IMG")
```

```{r test_t_1}
t.test(data = biometry_data, IMG ~ fast_food_rec)
```

<!-- Interprétation statistique et biologique -->

### Test t de Student 2

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_t_2}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_t_2}

```

<!--% Interprétation statistique et biologique -->

<!--# Travaillez jusqu'ici pour le module 8. Commencez à travailler sur le rapport (intro, mat&met). -->

### ANOVA à un facteur 1

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_anova1_1}
biometry_data %>.%
  sgroup_by(., sucre, genre) %>.%
  ssummarise(., mean = mean(imc, na.rm = T))
```

<!--% Hypothèse nulle et alternative -->

-   H0: μ1 = μ2 = ...= μk

-   H1:∃(i,j) tel que μi ≠ μj

<!--% Vérification des conditions d'application -->

```{r}

```

```{r}
bartlett.test(data = biometry_data, imc ~ sucre)
```

```{r test_anova1_1}

```

<!--% Interprétation statistique et biologique -->

### ANOVA à un facteur 2

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_anova1_2}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_anova1_2}

```

<!--% Interprétation statistique et biologique -->

<!--# Travaillez jusqu'ici pour le module 9. Commencez à rédiger la partie résultats avec la description des données. -->

### ANOVA à deux facteurs 1

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_anova2_1}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_anova2_1}

```

<!--% Interprétation statistique et biologique -->

### ANOVA à deux facteurs 2

<!--% Graphique ou tableau présentant les données par rapport au test à réaliser. -->

```{r plot_anova2_2}

```

<!--% Hypothèse nulle et alternative -->

<!--% Vérification des conditions d'application -->

```{r test_anova2_2}

```

<!--% Interprétation statistique et biologique -->

# Discussion et conclusions

<!--% Reprenez ci-dessous sous forme d'éléments de listes brefs les résultats les plus importants que vous retirez de votre analyse. Ils doivent vous guider pour décider quels tests (les plus intéressants) vous allez conserver dans le rapport. -->

-   ...

-   ...

-   ...

-   ...

-   ...

<!--# Important : ce document doit compiler SANS ERREURS avec le bouton 'Rendu' sinon le travail sera sanctionné lourdement. La compilation du document Quarto est maintenant considérée comme acquise. -->

# Référence

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
